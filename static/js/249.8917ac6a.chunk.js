"use strict";(self.webpackChunkaktyn_github_io=self.webpackChunkaktyn_github_io||[]).push([[249],{3249:(t,e,r)=>{r.r(e),r.d(e,{MeshSurfaceSampler:()=>b});var i=r(9408);const o=new i.lMl,u=new i.Pq0,s=new i.I9Y,n=new i.I9Y,a=new i.I9Y;class b{constructor(t){this.geometry=t.geometry,this.randomFunction=Math.random,this.indexAttribute=this.geometry.index,this.positionAttribute=this.geometry.getAttribute("position"),this.normalAttribute=this.geometry.getAttribute("normal"),this.colorAttribute=this.geometry.getAttribute("color"),this.uvAttribute=this.geometry.getAttribute("uv"),this.weightAttribute=null,this.distribution=null}setWeightAttribute(t){return this.weightAttribute=t?this.geometry.getAttribute(t):null,this}build(){const t=this.indexAttribute,e=this.positionAttribute,r=this.weightAttribute,i=t?t.count/3:e.count/3,u=new Float32Array(i);for(let a=0;a<i;a++){let i=1,s=3*a,n=3*a+1,b=3*a+2;t&&(s=t.getX(s),n=t.getX(n),b=t.getX(b)),r&&(i=r.getX(s)+r.getX(n)+r.getX(b)),o.a.fromBufferAttribute(e,s),o.b.fromBufferAttribute(e,n),o.c.fromBufferAttribute(e,b),i*=o.getArea(),u[a]=i}const s=new Float32Array(i);let n=0;for(let o=0;o<i;o++)n+=u[o],s[o]=n;return this.distribution=s,this}setRandomGenerator(t){return this.randomFunction=t,this}sample(t,e,r,i){const o=this.sampleFaceIndex();return this.sampleFace(o,t,e,r,i)}sampleFaceIndex(){const t=this.distribution[this.distribution.length-1];return this.binarySearch(this.randomFunction()*t)}binarySearch(t){const e=this.distribution;let r=0,i=e.length-1,o=-1;for(;r<=i;){const u=Math.ceil((r+i)/2);if(0===u||e[u-1]<=t&&e[u]>t){o=u;break}t<e[u]?i=u-1:r=u+1}return o}sampleFace(t,e,r,i,b){let c=this.randomFunction(),h=this.randomFunction();c+h>1&&(c=1-c,h=1-h);const d=this.indexAttribute;let l=3*t,f=3*t+1,A=3*t+2;return d&&(l=d.getX(l),f=d.getX(f),A=d.getX(A)),o.a.fromBufferAttribute(this.positionAttribute,l),o.b.fromBufferAttribute(this.positionAttribute,f),o.c.fromBufferAttribute(this.positionAttribute,A),e.set(0,0,0).addScaledVector(o.a,c).addScaledVector(o.b,h).addScaledVector(o.c,1-(c+h)),void 0!==r&&(void 0!==this.normalAttribute?(o.a.fromBufferAttribute(this.normalAttribute,l),o.b.fromBufferAttribute(this.normalAttribute,f),o.c.fromBufferAttribute(this.normalAttribute,A),r.set(0,0,0).addScaledVector(o.a,c).addScaledVector(o.b,h).addScaledVector(o.c,1-(c+h)).normalize()):o.getNormal(r)),void 0!==i&&void 0!==this.colorAttribute&&(o.a.fromBufferAttribute(this.colorAttribute,l),o.b.fromBufferAttribute(this.colorAttribute,f),o.c.fromBufferAttribute(this.colorAttribute,A),u.set(0,0,0).addScaledVector(o.a,c).addScaledVector(o.b,h).addScaledVector(o.c,1-(c+h)),i.r=u.x,i.g=u.y,i.b=u.z),void 0!==b&&void 0!==this.uvAttribute&&(s.fromBufferAttribute(this.uvAttribute,l),n.fromBufferAttribute(this.uvAttribute,f),a.fromBufferAttribute(this.uvAttribute,A),b.set(0,0).addScaledVector(s,c).addScaledVector(n,h).addScaledVector(a,1-(c+h))),this}}}}]);
//# sourceMappingURL=249.8917ac6a.chunk.js.map